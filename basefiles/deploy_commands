cd $downloads_prefix
wget --no-check-certificate https://sourceforge.net/projects/boost/files/boost/1.75.0/boost_1_75_0.tar.gz/download
tar -xf ./download
line_number=$i
cd $downloads_prefix
git clone https://deploy-1:x8BEfHUytzmT78ftoTnY@gitlab.newmexicoconsortium.org/lanl-ccu/batsim4.git
git clone https://deploy-1:_CmeAypLDgszp8SANVsm@gitlab.newmexicoconsortium.org/lanl-ccu/batsched4.git
cd $basefiles_prefix
git clone https://cswalke1:ekhr1Q_mL356zvCt_p2B@gitlab.newmexicoconsortium.org/lanl-ccu/simulator.git
cd $downloads_prefix
git clone https://framagit.org/simgrid/simgrid.git
git clone https://github.com/zeromq/libzmq.git
git clone https://github.com/redis/hiredis.git
git clone https://github.com/enki/libev.git
git clone https://github.com/alisw/GMP.git
git clone https://github.com/zeromq/cppzmq.git
git clone https://github.com/mpoquet/redox.git
git clone https://github.com/Tencent/rapidjson.git
git clone https://github.com/zeux/pugixml.git
git clone https://github.com/google/googletest.git
git clone https://framagit.org/batsim/intervalset.git
git clone https://github.com/docopt/docopt.cpp.git
git clone https://github.com/emilk/loguru.git

line_number="boost"
echo "gobin=$GOBIN     gopath=$GOPATH     goroot=$GOROOT    go111module=$GO111MODULE"
cd $downloads_prefix
cd ./boost_1_75_0/

./bootstrap.sh --prefix=$install_prefix --with-toolset=gcc
#this command does not get a  after it.  It fails some targets (66) but successfully does 17,6XX targets.  It may just be that it's not configured for those targets
#in any case it returns a non-zero number and will quit the chain of commands if expected to return zero(true) with an &&
./b2 install

#### don't need to compile Cmake since we are loading cmake above
#cd /home/$USER/Downloads/
#git clone https://github.com/Kitware/CMake.git &&
#cd ./CMake
#git checkout tags/v3.18.4 -b our_v3.18.4d
#./bootstrap --prefix=/home/$USER/Install -- -DCMAKE_USE_OPENSSL:BOOL=OFF
#gmake
#gmake install
line_number=$i

cd $downloads_prefix/simgrid/
git checkout tags/v3.29 -b our_v3.29
cmake -DBOOST_ROOT="$install_prefix" -DCMAKE_INSTALL_PREFIX="$install_prefix" -D CMAKE_C_COMPILER=gcc -D CMAKE_CXX_COMPILER=g++ $downloads_prefix/simgrid/  \
    -Denable_documentation=off \
    -Denable_java=off \
    -Denable_msg=on \
    -Denable_fortran=off \
    -Denable_model-checking=off \
    -Denable_ns3=off \
    -Denable_lua=off \
    -Denable_lib_in_jar=off \
    -Denable_maintainer_mode=off \
    -Denable_mallocators=on \
    -Denable_debug=off \
    -Denable_smpi=on \
    -Dminimal-bindings=on \
    -Denable_smpi_ISP_testsuite=off \
    -Denable_smpi_MPICH3_testsuite=off \
    -Denable_compile_warnings=off \
    -Denable_compile_optimizations=on \
    -Denable_lto=on
make
make install
line_number=$i
cd $downloads_prefix/libzmq
git checkout tags/v4.3.3 -b our_v4.3.3d
./autogen.sh
./configure --prefix=$install_prefix
make
make install
line_number=$i
cd $downloads_prefix/hiredis
git checkout tags/v0.14.0 -b our_v0.14.0d
make PREFIX=$install_prefix
#make install does not work here. tried it with DESTDIR and PREFIX.  Puts it in PREFIX/PKG_CONFIG_PATH
INSTALL="cp -pPR"
mkdir -p $install_prefix/include/hiredis/adapters
${INSTALL} hiredis.h async.h read.h sds.h $install_prefix/include/hiredis/
${INSTALL} adapters/*.h $install_prefix/include/hiredis/adapters
${INSTALL} libhiredis.so $install_prefix/lib/libhiredis.so.0.14
ln -sf $install_prefix/lib/libhiredis.so.0.14 $install_prefix/lib/libhiredis.so
${INSTALL} libhiredis.a $install_prefix/lib/
mkdir -p $install_prefix/lib/pkgconfig
source $basefiles_prefix/genHiRedisPC
line_number=$i
cd $downloads_prefix/libev
./configure --prefix=$install_prefix
make
make install
line_number=$i
cd $downloads_prefix/GMP
./configure --prefix=$install_prefix
make
make install
cd $install_prefix
export gmp_dir=`find ./ -name libgmp.so | awk -F/ '{print $2}'`
line_number=$i
cd $downloads_prefix/cppzmq
cmake -DCMAKE_PREFIX_PATH="$install_prefix" -DCMAKE_INSTALL_PREFIX="$install_prefix" ./
make
make install
line_number=$i
install_python
export PATH=$PATH:$install_prefix/bin
line_number=$i
cd $downloads_prefix/redox/
git checkout install-pkg-config-file
mkdir build && cd build
cmake -DCMAKE_INSTALL_PREFIX=$install_prefix $downloads_prefix/redox/
make
cd $downloads_prefix/redox/build/
make install
line_number=$i
mkdir $downloads_prefix/rapidjson/build && cd $downloads_prefix/rapidjson/build
cmake -DCMAKE_INSTALL_PREFIX=$install_prefix ..
make
make install
line_number=$i
cd $downloads_prefix/pugixml
mkdir $downloads_prefix/pugixml/build
cd $downloads_prefix/pugixml/build
cmake -DCMAKE_INSTALL_PREFIX=$install_prefix ..
make
make install
line_number=$i
cd $downloads_prefix/googletest
cmake -DCMAKE_INSTALL_PREFIX=$install_prefix
make
make install
line_number=$i
cd $downloads_prefix/intervalset
export BOOST_ROOT=$install_prefix
export PKG_CONFIG_PATH=$PKG_CONFIG_PATH:$install_prefix/lib64/pkgconfig:$install_prefix/lib/pkgconfig:$install_prefix/lib/x86_64-linux-gnu/pkgconfig
$python_prefix/bin/meson build --buildtype release --prefix $install_prefix
cd $downloads_prefix/intervalset/build/
$python_prefix/bin/ninja
$python_prefix/bin/ninja install
line_number=$i
cd $downloads_prefix/docopt.cpp/
mkdir build
cd build
cmake -DCMAKE_INSTALL_PREFIX=$install_prefix ..
make
make install
line_number=$i
source $basefiles_prefix/genGmpPC
source $basefiles_prefix/genEvPC
source $basefiles_prefix/genLoguruPC
line_number=$i
cd $downloads_prefix/loguru
g++ -std=c++11 -o libloguru.so -shared -pthread -fPIC loguru.cpp
cp $downloads_prefix/loguru/libloguru.so $install_prefix/lib/
cp $downloads_prefix/loguru/loguru.hpp $install_prefix/include/
line_number=$i
cd $downloads_prefix/batsim4
git checkout main
$python_prefix/bin/meson setup --wipe build
$python_prefix/bin/meson build --prefix=$install_prefix --buildtype release
$python_prefix/bin/ninja -C build
$python_prefix/bin/meson install -C build
line_number=$i
cd $downloads_prefix/batsched4
git checkout main
$python_prefix/bin/meson setup --wipe build
$python_prefix/bin/meson build --prefix=$install_prefix --buildtype release
$python_prefix/bin/ninja -C build
$python_prefix/bin/meson install -C build
line_number=$i
cd $basefiles_prefix/simulator
git checkout main
line_number=$i
cd $downloads_prefix
wget --no-check-certificate https://go.dev/dl/go1.19.2.linux-amd64.tar.gz
tar -xf go1.19.2.linux-amd64.tar.gz
mv ./go/bin/go $install_prefix/bin/
line_number=$i
go install -v framagit.org/batsim/batexpe/cmd/robin@latest
go install -v framagit.org/batsim/batexpe/cmd/robintest@latest



rm $basefiles_prefix/deploy.config

line_number="end"
